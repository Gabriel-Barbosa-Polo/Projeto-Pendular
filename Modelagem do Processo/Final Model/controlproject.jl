using ControlSystems
using Plots; plotly()

#Hθ = (2.240118904371009e-6s + 1.2096642083603447e-9(s^2)) / (2.040848906755061e-6s + 6.739550037394401e-6(s^2) - 0.00029441318669278096)
a0θ = 0
a1θ = 2.240118904371009e-6
a2θ = 1.2096642083603447e-9

b0θ = - 0.00029441318669278096
b1θ = 2.040848906755061e-6
b2θ = 6.739550037394401e-6



#HΦ = (1.2611507253471558e-6 + 6.810213916874641e-10s - 1.168960197377088e-11(s^3) - 2.1647411062538666e-8(s^2)) /
#       / (6.570472231493145e-9(s^2) + 2.1697846531846737e-8(s^3) - 9.478573653088625e-7s)

a0Φ = 1.2611507253471558e-6 
a1Φ = + 6.810213916874641e-10
a2Φ= - 2.1647411062538666e-8
a3Φ = - 1.168960197377088e-11

b0Φ= 0
b1Φ= - 9.478573653088625e-7
b2Φ= 6.570472231493145e-9
b3Φ= + 2.1697846531846737e-8

#Hn (θ/ϕ) = (0.0032194799966550006(s^2)) / (0.5629838321913844 - 0.009663509834366105(s^2))
a0Hn = 0
a1Hn = 0
a2Hn = 0.0032194799966550006
b0Hn =0.5629838321913844
b1Hn =0
b2Hn =- 0.009663509834366105


Hmaθ = tf([a2θ, a1θ, a0θ],[b2θ, b1θ, b0θ])
plot(pzmap(Hmaθ, title ="theta"))
zθ, pθ, kθ = zpkdata(Hmaθ)
zθ
pθ
kθ

HmaΦ = tf([a3Φ, a2Φ, a1Φ, a0Φ], [b3Φ, b2Φ, b1Φ, b0Φ])
pzmap(HmaΦ, title ="phi")
zΦ, pΦ, kΦ = zpkdata(HmaΦ)
zΦ
pΦ
kΦ

Hn = tf([a2Hn, a1Hn, a0Hn],[b2Hn, b1Hn, b0Hn])
pzmap(Hn)
zHn, pHn, kHn = zpkdata(Hn)
zHn
pHn
kHn

setPlotScale("dB")
bodeplot(Hmaθ)
bodeplot(HmaΦ)


Hdθ = c2d(Hmaθ, 1e-2)
HdΦ = c2d(HmaΦ, 1e-2)

#Hdθ
#0.00017948738441713786z^2 + 0.0029618632653510106z - 0.0031413506497678365
#--------------------------------------------------------------------------
#             1.0z^2 - 2.001339832770497z + 0.9969764123783533
#
#Sample Time: 0.01 (seconds)